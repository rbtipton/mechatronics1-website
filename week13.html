<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mechatronics 1: Week 13 Study Guide</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        .nav-button {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: 0.75rem 0.5rem;
          border-radius: 0.5rem;
          font-weight: 600;
          transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease;
          flex: 1; /* Make buttons take equal width */
          text-align: center;
        }
        .nav-button.active {
          background-color: #4f46e5; /* indigo-600 */
          color: white;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          transform: translateY(-2px);
        }
        .nav-button:not(.active) {
          background-color: #e5e7eb; /* gray-200 */
          color: #374151; /* gray-700 */
        }
        .nav-button:not(.active):hover {
          background-color: #d1d5db; /* gray-300 */
        }
        .nav-button svg {
          margin-bottom: 0.25rem;
        }
        @media (min-width: 640px) { /* sm breakpoint */
          .nav-button {
            padding: 1rem 1rem;
          }
        }
        @media (min-width: 768px) { /* md breakpoint */
          .nav-button {
            padding: 1rem 1.5rem;
          }
        }
        .formula-box {
            background-color: #e0f2fe; /* Light blue background */
            border-left: 4px solid #38bdf8; /* Blue border on left */
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: 'Fira Code', 'Cascadia Code', 'Consolas', monospace; /* Monospace font */
            font-size: 1rem;
            color: #0c4a6e; /* Darker blue text */
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
    </style>
</head>
<body class="antialiased">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Lucide React icons (inline SVGs for direct use in HTML)
        const BookOpenText = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>;
        const FlaskConical = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M10 2v6c0 2.2-1.8 4-4 4H2"/><path d="M14 2v6c0 2.2 1.8 4 4 4h4"/><path d="M21 15c.8-1 1-2.2.6-3.4-.4-1.1-1.5-1.7-2.7-1.6-1.2.1-2.2.9-2.6 2.1-.4 1.1-.2 2.5.6 3.4l2.9 3.2c1.3 1.4 3.3 1.4 4.6 0 .4-.5.7-1.2.8-1.9L21 15z"/><path d="M9 15c-.8-1-1-2.2-.6-3.4.4-1.1 1.5-1.7 2.7-1.6 1.2.1 2.2.9 2.6 2.1.4 1.1.2 2.5-.6 3.4l-2.9 3.2c-1.3 1.4-3.3 1.4-4.6 0-.4-.5-.7-1.2-.8-1.9L9 15z"/></svg>;
        const Award = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="8" r="6"/><path d="M15.477 12.89L17.18 21l-5.15-3.62L6.82 21l1.703-8.11"/></svg>;
        const CheckCircle = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="m9 11 3 3L22 4"/></svg>;
        const XCircle = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>;
        const Home = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>;

        // Icons for Week 13
        const Cog = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z"/><path d="M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="M20 12h2"/><path d="M2 12h2"/><path d="M19.7 4.3l-1.4 1.4"/><path d="M6.3 17.7l-1.4 1.4"/><path d="M4.3 4.3l1.4 1.4"/><path d="M17.7 17.7l1.4 1.4"/></svg>;
        const Gauge = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 14c1.449 0 2.706-.78 3.407-1.921A4.998 4.998 0 0 0 12 9c-1.449 0-2.706.78-3.407 1.921A4.998 4.998 0 0 0 12 14z"/><path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20z"/><path d="M12 14v6"/><path d="M12 2v2"/><path d="M16.24 7.76l-1.41 1.41"/><path d="M7.76 7.76l1.41 1.41"/></svg>;
        const Droplets = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M7 16c-2.76 0-5-2.24-5-5s2.24-5 5-5c.44 0 .87.07 1.28.2"/><path d="M12.55 4.35a5.5 5.5 0 0 1 8.23 6.39c-.39.77-.96 1.46-1.67 2.03L12 22l-4.1-4.1"/><path d="M16.8 9.2c1.07.95 2.22 1.58 3.45 1.83"/><path d="M12 22v-6.5"/></svg>;


        // Concept Review Component
        const ConceptReview = () => {
          return (
            <div className="p-6 bg-white rounded-lg shadow-lg">
              <h2 className="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2">Week 13: Servomotors, Stepper Motors & Fluid Power Actuators</h2>

              {/* Servomotors: Precise Angular Position Control */}
              <section className="mb-8">
                <h3 className="text-2xl font-semibold text-indigo-700 mb-3 flex items-center">
                    <Cog className="w-7 h-7 mr-3 text-blue-600"/>
                    1. Servomotors: Precise Angular Position Control
                </h3>
                <p className="text-gray-700 leading-relaxed mb-2">
                  <span className="font-medium">Definition:</span> A servomotor (often simply "servo") is a rotary actuator that allows for precise control of angular position, velocity, and acceleration.
                </p>
                <h4 className="text-xl font-medium text-gray-800 mb-2 mt-4">Key Difference from DC/Stepper Motors:</h4>
                <ul className="list-disc list-inside text-gray-700 ml-4 space-y-2">
                  <li>While DC motors provide continuous rotation with speed control, and stepper motors provide discrete steps without feedback, servomotors are designed for <span className="font-bold">precise positional control</span> through a <span className="font-bold">closed-loop feedback system</span>.</li>
                </ul>
                <h4 className="text-xl font-medium text-gray-800 mb-2 mt-4">Principle of Operation (Hobby Servos):</h4>
                <ul className="list-disc list-inside text-gray-700 ml-4 space-y-2">
                  <li>A typical hobby servomotor consists of four main components integrated into one compact unit:
                    <ul className="list-circle list-inside ml-4">
                      <li><span className="font-medium">DC Motor:</span> Provides the mechanical power.</li>
                      <li><span className="font-medium">Gear Reduction:</span> Increases torque and reduces speed, allowing the small motor to move heavier loads.</li>
                      <li><span className="font-medium">Position Sensor (Potentiometer):</span> Provides feedback on the current angular position of the output shaft.</li>
                      <li><span className="font-medium">Control Circuit (PID Controller):</span> Compares the desired position (from input signal) with the actual position (from sensor) and adjusts the motor's power to correct any error.</li>
                    </ul>
                  </li>
                </ul>
                <h4 className="text-xl font-medium text-gray-800 mb-2 mt-4">Control with Arduino (Servo Library):</h4>
                <ul className="list-disc list-inside text-gray-700 ml-4 space-y-2">
                  <li>Hobby servos are typically controlled by a Pulse Width Modulation (PWM) signal, but it's a specific type of PWM where the <span className="font-bold">pulse width</span> (duration of the HIGH pulse) determines the angular position, not the duty cycle.</li>
                  <li>Arduino's `Servo.h` library simplifies control:
                    <ul className="list-circle list-inside ml-4">
                      <li>`servo.attach(pin)`: Attaches a servo object to a specified pin.</li>
                      <li>`servo.write(angle)`: Sets the servo shaft to a specific angle (0-180 degrees).</li>
                      <li>`servo.writeMicroseconds(us)`: Sets the pulse width directly (e.g., 1000us for 0 degrees, 1500us for 90 degrees, 2000us for 180 degrees).</li>
                    </ul>
                  </li>
                </ul>
                <h4 className="text-xl font-medium text-gray-800 mb-2 mt-4">Characteristics:</h4>
                <ul className="list-disc list-inside text-gray-700 ml-4 space-y-2">
                  <li><span className="font-medium">Closed-Loop Control:</span> Self-correcting due to internal feedback.</li>
                  <li><span className="font-medium">Precise Positioning:</span> Can move to and hold specific angles.</li>
                  <li><span className="font-medium">Limited Rotation:</span> Most hobby servos have a limited range (e.g., 0-180 or 0-270 degrees). Continuous rotation servos exist but behave more like geared DC motors with speed control.</li>
                  <li><span className="font-medium">High Torque at Low Speed:</span> Due to gear reduction.</li>
                </ul>
              </section>

              {/* Stepper Motors: Discrete Step Control */}
              <section className="mb-8">
                <h3 className="text-2xl font-semibold text-indigo-700 mb-3 flex items-center">
                    <Cog className="w-7 h-7 mr-3 text-green-600"/>
                    2. Stepper Motors: Discrete Step Control
                </h3>
                <p className="text-gray-700 leading-relaxed mb-2">
                  <span className="font-medium">Definition:</span> An electromechanical device that converts electrical pulses into discrete mechanical rotational movements (steps).
                </p>
                <h4 className="text-xl font-medium text-gray-800 mb-2 mt-4">Key Feature:</h4>
                <ul className="list-disc list-inside text-gray-700 ml-4 space-y-2">
                  <li>They move in fixed, repeatable angular increments (steps).</li>
                  <li><span className="font-medium">Open-Loop Control:</span> Stepper motors are often operated in <span className="font-bold">open-loop control</span>, meaning they typically do not require position feedback sensors (like encoders) to know their position. The controller simply counts the pulses sent, assuming the motor executes each step perfectly. This simplifies the control system.</li>
                </ul>
                <h4 className="text-xl font-medium text-gray-800 mb-2 mt-4">Principle of Operation:</h4>
                <ul className="list-disc list-inside text-gray-700 ml-4 space-y-2">
                  <li>The motor has multiple coils (windings) arranged around a central rotor with permanent magnets or soft iron teeth.</li>
                  <li>By sequentially energizing these coils in a specific pattern, the magnetic field shifts, causing the rotor to align itself with the new field, thus moving one step.</li>
                </ul>
                <h4 className="text-xl font-medium text-gray-800 mb-2 mt-4">Types:</h4>
                <ul className="list-disc list-inside text-gray-700 ml-4 space-y-2">
                  <li><span className="font-medium">Unipolar Stepper Motors:</span> Have a center tap on each winding, allowing current to flow in only one direction. Easier to control but less torque.</li>
                  <li><span className="font-medium">Bipolar Stepper Motors:</span> Have no center tap; current must be reversible through the coils. More complex to drive (requires H-bridge type driver for each coil) but provide higher torque.</li>
                </ul>
                <h4 className="text-xl font-medium text-gray-800 mb-2 mt-4">Control Modes:</h4>
                <ul className="list-disc list-inside text-gray-700 ml-4 space-y-2">
                  <li><span className="font-medium">Full Step:</span> Simplest, highest torque, but coarser resolution.</li>
                  <li><span className="font-medium">Half Step:</span> Doubles the resolution, smoother motion, slightly less torque.</li>
                  <li><span className="font-medium">Microstepping:</span> Varies current in windings to achieve very fine resolution and extremely smooth motion, but requires more complex drivers.</li>
                </ul>
                <h4 className="text-xl font-medium text-gray-800 mb-2 mt-4">Characteristics:</h4>
                <ul className="list-disc list-inside text-gray-700 ml-4 space-y-2">
                  <li><span className="font-medium">Precise Positioning:</span> Excellent for applications requiring exact, repeatable movements (e.g., 3D printers, CNC machines).</li>
                  <li><span className="font-medium">Holding Torque:</span> Can hold a position without power when stationary (for permanent magnet types).</li>
                  <li><span className="font-medium">Loss of Steps:</span> If the load is too high or acceleration too rapid, the motor can "lose steps," leading to position errors in open-loop control.</li>
                  <li><span className="font-medium">Power Consumption:</span> Can consume significant power even when stationary (holding torque).</li>
                </ul>
              </section>

              {/* Fluid Power Actuators: Pneumatic & Hydraulic Systems */}
              <section className="mb-8">
                <h3 className="text-2xl font-semibold text-indigo-700 mb-3 flex items-center">
                    <Droplets className="w-7 h-7 mr-3 text-teal-600"/>
                    3. Fluid Power Actuators: Pneumatic & Hydraulic Systems
                </h3>
                <p className="text-gray-700 leading-relaxed mb-2">
                  Actuators that use compressed gases (pneumatics) or pressurized liquids (hydraulics) to generate powerful linear or rotary motion.
                </p>
                <h4 className="text-xl font-medium text-gray-800 mb-2 mt-4">A. Pneumatic Systems:</h4>
                <ul className="list-disc list-inside text-gray-700 ml-4 space-y-2">
                  <li><span className="font-medium">Working Fluid:</span> Compressed air (or other gas).</li>
                  <li><span className="font-medium">Components:</span> Compressor, air tank, FRL (Filter, Regulator, Lubricator) unit, directional control valves, pneumatic cylinders (linear) or motors (rotary).</li>
                  <li><span className="font-medium">Characteristics:</span>
                    <ul className="list-circle list-inside ml-4">
                      <li><span className="font-medium">Fast Response:</span> Air is highly compressible, allowing for quick movements.</li>
                      <li><span className="font-medium">Clean:</span> No fluid leaks, suitable for food processing, medical applications.</li>
                      <li><span className="font-medium">Moderate Force:</span> Limited by available air pressure.</li>
                      <li><span className="font-medium">"Spongy" Motion:</span> Due to air compressibility, precise positioning under varying loads can be challenging without feedback.</li>
                    </ul>
                  </li>
                  <li><span className="font-medium">Applications:</span> Pick-and-place robots, clamping, opening/closing valves, assembly lines.</li>
                </ul>
                <h4 className="text-xl font-medium text-gray-800 mb-2 mt-4">B. Hydraulic Systems:</h4>
                <ul className="list-disc list-inside text-gray-700 ml-4 space-y-2">
                  <li><span className="font-medium">Working Fluid:</span> Incompressible liquid (typically oil).</li>
                  <li><span className="font-medium">Components:</span> Hydraulic pump, reservoir, directional control valves, hydraulic cylinders (linear) or motors (rotary).</li>
                  <li><span className="font-medium">Characteristics:</span>
                    <ul className="list-circle list-inside ml-4">
                      <li><span className="font-medium">Extremely High Force & Torque:</span> Due to the incompressibility of oil, capable of generating immense forces.</li>
                      <li><span className="font-medium">High Stiffness & Rigidity:</span> Very little "give" or "squishiness," allowing for precise and rigid force application.</li>
                      <li><span className="font-medium">Slow Response:</span> Compared to pneumatics, due to fluid inertia and higher pressures.</li>
                      <li><span className="font-medium">Messy:</span> Potential for oil leaks.</li>
                    </ul>
                  </li>
                  <li><span className="font-medium">Applications:</span> Heavy construction equipment (excavators), industrial presses, aircraft landing gear, power steering.</li>
                </ul>
              </section>
            </div>
          );
        };

        // Actuator Control Simulator Sandbox
        const ActuatorControlSimulator = () => {
          const [servoAngle, setServoAngle] = useState(90);
          const [stepperSteps, setStepperSteps] = useState(0);
          const [pneumaticState, setPneumaticState] = useState('Retracted'); // 'Retracted', 'Extended'
          const [hydraulicForce, setHydraulicForce] = useState(0); // kN
          const [message, setMessage] = useState('');

          useEffect(() => {
            updateMessages();
          }, [servoAngle, stepperSteps, pneumaticState, hydraulicForce]);

          const updateMessages = () => {
            let msg = "Actuator Status:\n";
            msg += `  - Servo: Set to ${servoAngle}°\n`;
            msg += `  - Stepper: Moved ${stepperSteps} steps from home\n`;
            msg += `  - Pneumatic Cylinder: ${pneumaticState}\n`;
            msg += `  - Hydraulic System: Applying ${hydraulicForce} kN of force\n`;
            setMessage(msg);
          };

          return (
            <div className="p-6 bg-white rounded-lg shadow-lg">
              <h2 className="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2">Actuator Control Simulator</h2>
              <p className="text-gray-700 mb-4">
                Control different types of actuators and observe their simulated states.
              </p>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                {/* Servo Control */}
                <div className="flex flex-col p-4 border border-gray-200 rounded-lg bg-gray-50">
                  <h3 className="text-xl font-semibold text-gray-800 mb-3">Servomotor Control</h3>
                  <label htmlFor="servoAngleInput" className="text-lg font-medium text-gray-700 mb-2">Servo Angle (°): {servoAngle}</label>
                  <input
                    type="range"
                    id="servoAngleInput"
                    min="0"
                    max="180"
                    step="1"
                    value={servoAngle}
                    onChange={(e) => setServoAngle(parseInt(e.target.value))}
                    className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer range-lg"
                  />
                  <div className="flex justify-between text-sm text-gray-600 mt-1">
                    <span>0°</span>
                    <span>90°</span>
                    <span>180°</span>
                  </div>
                </div>

                {/* Stepper Control */}
                <div className="flex flex-col p-4 border border-gray-200 rounded-lg bg-gray-50">
                  <h3 className="text-xl font-semibold text-gray-800 mb-3">Stepper Motor Control</h3>
                  <label htmlFor="stepperStepsInput" className="text-lg font-medium text-gray-700 mb-2">Steps from Home: {stepperSteps}</label>
                  <input
                    type="range"
                    id="stepperStepsInput"
                    min="-100"
                    max="100"
                    step="1"
                    value={stepperSteps}
                    onChange={(e) => setStepperSteps(parseInt(e.target.value))}
                    className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer range-lg"
                  />
                  <div className="flex justify-between text-sm text-gray-600 mt-1">
                    <span>-100 steps</span>
                    <span>0 steps (Home)</span>
                    <span>+100 steps</span>
                  </div>
                </div>

                {/* Pneumatic Control */}
                <div className="flex flex-col p-4 border border-gray-200 rounded-lg bg-gray-50">
                  <h3 className="text-xl font-semibold text-gray-800 mb-3">Pneumatic Cylinder</h3>
                  <div className="flex justify-center gap-4">
                    <button
                      onClick={() => setPneumaticState('Retracted')}
                      className={`py-2 px-4 rounded-md font-semibold transition duration-300 ease-in-out shadow-md flex-1 ${
                        pneumaticState === 'Retracted' ? 'bg-blue-700 text-white' : 'bg-blue-600 text-white hover:bg-blue-700'
                      }`}
                    >
                      Retract
                    </button>
                    <button
                      onClick={() => setPneumaticState('Extended')}
                      className={`py-2 px-4 rounded-md font-semibold transition duration-300 ease-in-out shadow-md flex-1 ${
                        pneumaticState === 'Extended' ? 'bg-blue-700 text-white' : 'bg-blue-600 text-white hover:bg-blue-700'
                      }`}
                    >
                      Extend
                    </button>
                  </div>
                </div>

                {/* Hydraulic Control */}
                <div className="flex flex-col p-4 border border-gray-200 rounded-lg bg-gray-50">
                  <h3 className="text-xl font-semibold text-gray-800 mb-3">Hydraulic System</h3>
                  <label htmlFor="hydraulicForceInput" className="text-lg font-medium text-gray-700 mb-2">Applied Force (kN): {hydraulicForce}</label>
                  <input
                    type="range"
                    id="hydraulicForceInput"
                    min="0"
                    max="100"
                    step="1"
                    value={hydraulicForce}
                    onChange={(e) => setHydraulicForce(parseInt(e.target.value))}
                    className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer range-lg"
                  />
                  <div className="flex justify-between text-sm text-gray-600 mt-1">
                    <span>0 kN</span>
                    <span>50 kN</span>
                    <span>100 kN</span>
                  </div>
                </div>
              </div>

              <div className="mt-6 p-4 bg-blue-100 border border-blue-400 text-blue-700 rounded-md font-semibold whitespace-pre-wrap">
                {message}
              </div>
            </div>
          );
        };


        // Practice Problems Component
        const PracticeProblems = () => {
          const [activeTab, setActiveTab] = useState('homework');

          const homeworkQuestions = [
            {
              id: 1,
              type: 'text',
              question: 'Explain the key difference in control philosophy between a servomotor and a stepper motor. For what type of application would each be more suitable?',
              answer: 'Servomotor: Operates using <span class="font-bold">closed-loop control</span>. It has an internal position sensor (e.g., potentiometer or encoder) that provides feedback to a control circuit. The control circuit continuously compares the desired position with the actual position and adjusts the motor\'s power to correct any error, ensuring precise positioning. Suitable for applications requiring precise angular positioning, smooth motion, and high torque at varying speeds, such as robotic joints, camera gimbals, or RC vehicles.\n\nStepper Motor: Often operates using <span class="font-bold">open-loop control</span>. It moves in discrete, fixed steps by sequentially energizing its coils. The controller assumes the motor executes each step perfectly and simply counts the pulses sent. It typically does not require a feedback sensor for basic operation. Suitable for applications requiring precise, repeatable positioning without feedback, such as 3D printers, CNC machines, or plotters, where the load is well-known and step loss is unlikely.',
              explanation: 'The fundamental difference lies in feedback. Servos use feedback to achieve and maintain position, making them more robust to varying loads. Steppers rely on precise pulse counting, making them simpler to control in applications with predictable loads, but susceptible to step loss if overloaded.'
            },
            {
              id: 2,
              type: 'text',
              question: 'Describe how a hobby servomotor achieves precise angular positioning. What are its main internal components?',
              answer: 'A hobby servomotor achieves precise angular positioning through a <span class="font-bold">closed-loop feedback system</span>. It receives a control signal (typically a PWM pulse width) indicating the desired angle. Internally, its control circuit compares this desired angle with the actual angle of the output shaft, which is measured by a built-in position sensor (usually a potentiometer).\n\nIts main internal components are:\n1.  <span class="font-bold">DC Motor:</span> Provides the rotational power.\n2.  <span class="font-bold">Gear Reduction:</span> A set of gears that reduces the motor\'s speed and increases its torque, allowing the servo to move a load.\n3.  <span class="font-bold">Position Sensor (Potentiometer):</span> Connected to the output shaft, it provides an electrical signal proportional to the current angular position.\n4.  <span class="font-bold">Control Circuit (PID Controller):</span> Reads the desired angle from the input signal and the actual angle from the potentiometer, calculates the error, and drives the DC motor until the error is minimized.',
              explanation: 'The combination of a DC motor, gear train, position sensor, and control circuit allows the servo to continuously monitor and adjust its position, effectively "closing the loop" to maintain the desired angle.'
            },
            {
              id: 3,
              type: 'multiple_choice',
              question: 'Which type of fluid power system is characterized by extremely high force capability and high stiffness (minimal "give") due to the incompressibility of its working fluid?',
              options: ['A) Pneumatic System', 'B) Hydraulic System', 'C) Both Pneumatic and Hydraulic Systems', 'D) Neither Pneumatic nor Hydraulic Systems'],
              correctAnswer: 'B) Hydraulic System',
              explanation: 'Hydraulic systems use incompressible liquids (like oil), which allows them to transmit immense forces with very little deflection or "squishiness," resulting in high stiffness and rigidity. Pneumatic systems use compressible air, making them faster but less stiff and capable of lower forces.'
            },
            {
              id: 4,
              type: 'text',
              question: 'You are designing a robotic arm for a pick-and-place operation that requires very fast, repetitive linear movements of a lightweight object. Would you choose a pneumatic or hydraulic cylinder for this task, and why?',
              answer: 'For very fast, repetitive linear movements of a lightweight object, a <span class="font-bold">pneumatic cylinder</span> would be the better choice.\n\nReasons:\n1.  <span class="font-bold">Speed:</span> Pneumatic systems use compressed air, which is highly compressible, allowing for very rapid extension and retraction of cylinders.\n2.  <span class="font-bold">Cleanliness:</span> Air systems are inherently cleaner as there are no oil leaks, which is often desirable in manufacturing or assembly environments.\n3.  <span class="font-bold">Cost & Simplicity:</span> Pneumatic systems are generally simpler and less expensive to implement for moderate force, high-speed applications compared to hydraulics.\n\nHydraulic systems, while capable of much higher forces, are typically slower, messier, and more complex, making them overkill for lightweight, high-speed tasks.',
              explanation: 'The compressibility of air makes pneumatic systems fast, while the incompressibility of oil makes hydraulic systems powerful and rigid. For lightweight, high-speed tasks, speed is prioritized, making pneumatics the ideal choice.'
            },
            {
              id: 5,
              type: 'text',
              question: 'A 3D printer uses stepper motors for its X, Y, and Z axes. Why are limit switches (or Hall-effect sensors) often used in conjunction with these open-loop stepper motors for "homing" the printer?',
              answer: 'Limit switches (or Hall-effect sensors) are used with open-loop stepper motors for "homing" a 3D printer because stepper motors, by themselves, operate in open-loop control and do not inherently know their absolute position, especially after power-up or if steps are lost due to external forces or missed pulses.\n\n"Homing" involves driving the print head (or bed) towards a known end-stop until it activates a limit switch. This tells the printer\'s controller that the print head is now at a precise, known reference (home) position (e.g., X=0, Y=0, Z=0). From this established home position, the controller can then accurately track all subsequent movements by simply counting the steps it commands the stepper motors to take. These sensors provide a necessary <span class="font-bold">absolute reference point</span> to re-zero the open-loop system and ensure accurate positioning at the start of each print or operation.',
              explanation: 'While steppers are precise in their incremental movements, they lack absolute position feedback. Limit switches provide a crucial "reset" or calibration point, allowing the system to re-establish a known absolute position and prevent cumulative errors from affecting future movements.'
            }
          ];

          const [homeworkAnswers, setHomeworkAnswers] = useState({});
          const [multipleChoiceSelections, setMultipleChoiceSelections] = useState({});
          const [quizResults, setQuizResults] = useState({}); // For multiple choice validation

          const handleHomeworkChange = (id, value) => {
            setHomeworkAnswers(prev => ({
              ...prev,
              [id]: value
            }));
          };

          const handleMultipleChoiceSelect = (questionId, selectedOption) => {
            setMultipleChoiceSelections(prev => ({
              ...prev,
              [questionId]: selectedOption
            }));
          };

          const checkQuizAnswers = () => {
            const newResults = {};
            homeworkQuestions.forEach(q => {
              if (q.type === 'multiple_choice') {
                newResults[q.id] = multipleChoiceSelections[q.id] === q.correctAnswer;
              }
            });
            setQuizResults(newResults);
          };

          const resetQuiz = () => {
            setMultipleChoiceSelections({});
            setQuizResults({});
          };


          return (
            <div className="p-6 bg-white rounded-lg shadow-lg">
              <h2 className="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2">Practice Problems</h2>

              <div className="flex mb-6 space-x-4">
                <button
                  onClick={() => setActiveTab('homework')}
                  className={`px-6 py-3 rounded-md font-semibold transition duration-300 ${
                    activeTab === 'homework' ? 'bg-indigo-600 text-white shadow-md' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                  }`}
                >
                  Homework Questions
                </button>
              </div>

              {activeTab === 'homework' && (
                <div>
                  <h3 className="text-2xl font-semibold text-indigo-700 mb-4 flex items-center">
                    <BookOpenText className="w-7 h-7 mr-3 text-blue-500"/>
                    Homework Questions
                  </h3>
                  <p className="text-gray-700 mb-4">
                    Instructions: Show all work and steps clearly.
                  </p>
                  {homeworkQuestions.map((q) => (
                    <div key={q.id} className="mb-8 p-4 border border-gray-200 rounded-lg bg-gray-50">
                      <p className="text-lg font-medium text-gray-900 mb-3">{q.id}. {q.question}</p>
                      {q.type === 'text' ? (
                        <textarea
                          className="w-full p-3 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 h-24"
                          placeholder="Type your answer here..."
                          value={homeworkAnswers[q.id] || ''}
                          onChange={(e) => handleHomeworkChange(q.id, e.target.value)}
                        ></textarea>
                      ) : q.type === 'multiple_choice' ? (
                        <div className="space-y-2">
                          {q.options.map((option, index) => (
                            <label key={index} className="flex items-center text-gray-700 cursor-pointer">
                              <input
                                type="radio"
                                name={`quiz-${q.id}`}
                                value={option}
                                checked={multipleChoiceSelections[q.id] === option}
                                onChange={() => handleMultipleChoiceSelect(q.id, option)}
                                className="form-radio h-4 w-4 text-indigo-600"
                              />
                              <span className="ml-2">{option}</span>
                            </label>
                          ))}
                        </div>
                      ) : null}
                      {q.type === 'multiple_choice' && quizResults[q.id] !== undefined && (
                        <div className="mt-3 flex items-center">
                          {quizResults[q.id] ? (
                            <CheckCircle className="text-green-500 mr-2" />
                          ) : (
                            <XCircle className="text-red-500 mr-2" />
                          )}
                          <span className={`font-semibold ${quizResults[q.id] ? 'text-green-700' : 'text-red-700'}`}>
                            {quizResults[q.id] ? 'Correct!' : 'Incorrect.'}
                          </span>
                        </div>
                      )}
                      {q.type === 'multiple_choice' && quizResults[q.id] !== undefined && !quizResults[q.id] && (
                        <div className="mt-2 text-sm text-gray-600">
                          <p className="font-medium">Correct Answer: {q.correctAnswer}</p>
                        </div>
                      )}
                      <details className="mt-4 p-3 bg-indigo-50 rounded-md cursor-pointer">
                        <summary className="font-semibold text-indigo-800">Show Explanation/Answer</summary>
                        <div className="mt-2 text-indigo-700">
                          <p className="whitespace-pre-wrap">{q.explanation}</p>
                        </div >
                      </details>
                    </div>
                  ))}
                  <div className="flex gap-4 mt-6">
                    <button
                      onClick={checkQuizAnswers}
                      className="flex-1 bg-indigo-600 text-white py-3 px-6 rounded-md hover:bg-indigo-700 transition duration-300 ease-in-out shadow-md"
                    >
                      Check Multiple Choice Answers
                    </button>
                    <button
                      onClick={resetQuiz}
                      className="flex-1 bg-gray-300 text-gray-800 py-3 px-6 rounded-md hover:bg-gray-400 transition duration-300 ease-in-out shadow-md"
                    >
                      Reset Multiple Choice
                    </button>
                  </div>
                </div>
              )}
            </div>
          );
        };


        // Main App Component
        const App = () => {
          const [activeSection, setActiveSection] = useState('review'); // 'review', 'sandbox', 'practice'

          return (
            <div className="min-h-screen bg-gray-100 font-inter text-gray-900 p-4 sm:p-6 md:p-8">
              <header className="text-center mb-8">
                <h1 className="text-4xl sm:text-5xl font-extrabold text-indigo-800 mb-2">
                  Mechatronics 1 Study Guide
                </h1>
                <p className="text-xl sm:text-2xl text-gray-600">Week 13: Servomotors, Stepper Motors & Fluid Power Actuators</p>
                <a href="index.html" className="mt-4 inline-flex items-center bg-gray-200 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-300 transition duration-300">
                    <Home className="w-5 h-5 mr-2" />
                    Back to Course Hub
                </a>
              </header>

              <nav className="flex justify-center gap-4 mb-8 flex-wrap">
                <button
                  onClick={() => setActiveSection('review')}
                  className={`nav-button ${activeSection === 'review' ? 'active' : ''}`}
                >
                  <BookOpenText className="w-6 h-6 sm:w-8 sm:h-8" />
                  <span className="text-sm sm:text-base">Concept Review</span>
                </button>
                <button
                  onClick={() => setActiveSection('sandbox')}
                  className={`nav-button ${activeSection === 'sandbox' ? 'active' : ''}`}
                >
                  <FlaskConical className="w-6 h-6 sm:w-8 sm:h-8" />
                  <span className="text-sm sm:text-base">Interactive Sandbox</span>
                </button>
                <button
                  onClick={() => setActiveSection('practice')}
                  className={`nav-button ${activeSection === 'practice' ? 'active' : ''}`}
                >
                  <Award className="w-6 h-6 sm:w-8 sm:h-8" />
                  <span className="text-sm sm:text-base">Practice Problems</span>
                </button>
              </nav>

              <main className="container">
                {activeSection === 'review' && <ConceptReview />}
                {activeSection === 'sandbox' && <ActuatorControlSimulator />}
                {activeSection === 'practice' && <PracticeProblems />}
              </main>

              <footer className="text-center text-gray-500 text-sm mt-12">
                <p>&copy; {new Date().getFullYear()} Mechatronics 1 Study Guide. All rights reserved.</p>
              </footer>
            </div>
          );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
